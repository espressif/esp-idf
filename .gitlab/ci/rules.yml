############
# Patterns #
############
.patterns-c-files: &patterns-c-files
  - ".gitlab/ci/static-code-analysis.yml"

  - "tools/ci/static-analysis-rules.yml"
  - "tools/ci/clang_tidy_dirs.txt"

  - "**/*.{c,C,cpp}"
  - "**/*.{h,H,hpp}"
  - "components/**/Kconfig"
  - "components/**/CMakeList.txt"

.patterns-python-cache: &patterns-python-cache
  - "tools/requirements.json"
  - "tools/requirements/requirements.*.txt"

.patterns-python-files: &patterns-python-files
  - ".gitlab/ci/static-code-analysis.yml"
  - "**/*.py"

.patterns-sonarqube-files: &patterns-sonarqube-files
  - "tools/ci/sonar_exclude_list.txt"

.patterns-example_test: &patterns-example_test
  - "tools/ci/idf_pytest/**/*"
  - "tools/ci/python_packages/gitlab_api.py"
  - "tools/ci/python_packages/idf_http_server_test/**/*"
  - "tools/ci/python_packages/idf_iperf_test_util/**/*"
  - "tools/ci/python_packages/common_test_methods.py"

  - "tools/esp_prov/**/*"
  - "examples/**/*"

.patterns-build-example_test: &patterns-build-example_test
  - "tools/ci/get_supported_examples.sh"

.patterns-build_components: &patterns-build_components
  # components files except "test*/" "host*/" folders
  # ?? to include folders less than 4 characters
  - "components/*/???[!t]*/**/*"
  - "components/*/??[!s]?*/**/*"
  - "components/*/???/**/*"
  - "components/*/??/**/*"
  - "components/*/*"
  - "components/*"
  # Add folders excluded by "???[!t]" and "??[!s]?"
  # pre-commit: tools/ci/check_rules_components_patterns.py
  - "components/bt/host/**/*"

.patterns-downloadable-tools: &patterns-downloadable-tools
  - "tools/idf_tools.py"
  - "tools/tools.json"

.patterns-build_template-app: &patterns-build_template-app
  - "tools/ci/build_template_app.sh"

.patterns-build_system: &patterns-build_system
  - "tools/cmake/**/*"
  - "tools/kconfig_new/**/*"
  - "tools/idf.py"
  - "tools/idf_py_actions/**/*"
  - "tools/requirements.json"
  - "tools/ci/test_build_system*.sh"
  - "tools/ci/test_build_system*.py"
  - "tools/ci/ci_build_apps.py"
  - "tools/test_build_system/**/*"

.patterns-custom_test: &patterns-custom_test
  - "tools/ci/idf_pytest/**/*"
  - "tools/ci/python_packages/gitlab_api.py"
  - "tools/ci/python_packages/common_test_methods.py"

  - "tools/test_apps/**/*"
  - "tools/ldgen/**/*"

.patterns-component_ut: &patterns-component_ut
  - "tools/ci/idf_pytest/**/*"
  - "tools/ci/python_packages/gitlab_api.py"
  - "tools/ci/python_packages/common_test_methods.py"
  - "tools/test_apps/configs/sdkconfig.debug_helpers"

  - "components/**/*"

.patterns-component_ut-i154: &patterns-component_ut-i154
  - "components/{esp_phy,esp_coex}/???[!t]*/**/*"
  - "components/{esp_phy,esp_coex}/??[!s]?*/**/*"
  - "components/{esp_phy,esp_coex}/???/**/*"
  - "components/{esp_phy,esp_coex}/*"
  - "components/ieee802154/**/*"

.patterns-example_test-i154: &patterns-example_test-i154
  - "components/{esp_netif,ieee802154,lwip,openthread}/???[!t]*/**/*"
  - "components/{esp_netif,ieee802154,lwip,openthread}/??[!s]?*/**/*"
  - "components/{esp_netif,ieee802154,lwip,openthread}/???/**/*"
  - "components/{esp_netif,ieee802154,lwip,openthread}/??/**/*"
  - "components/{esp_netif,ieee802154,lwip,openthread}/*"
  - "examples/common_components/iperf/**/*"
  - "examples/openthread/**/*"

.patterns-target_test-wifi: &patterns-target_test-wifi
  - "components/{esp_wifi,esp_netif,lwip,esp_phy,wpa_supplicant,esp_coex}/???[!t]*/**/*"
  - "components/{esp_wifi,esp_netif,lwip,esp_phy,wpa_supplicant,esp_coex}/??[!s]?*/**/*"
  - "components/{esp_wifi,esp_netif,lwip,esp_phy,wpa_supplicant,esp_coex}/???/**/*"
  - "components/{esp_wifi,esp_netif,lwip,esp_phy,wpa_supplicant,esp_coex}/??/**/*"
  - "components/{esp_wifi,esp_netif,lwip,esp_phy,wpa_supplicant,esp_coex}/*"

.patterns-component_ut-wifi: &patterns-component_ut-wifi
  - "components/esp_wifi/**/*"

.patterns-build_macos: &patterns-build_macos
  - "tools/ci/test_configure_ci_environment.sh"

.patterns-build_check: &patterns-build_check
  - "tools/test_build_system/**/*"
  - "tools/ci/test_configure_ci_environment.sh"
  - "tools/gen_esp_err_to_name.py"
  - "tools/ci/check_soc_headers_leak.py"
  - "tools/ci/check_esp_memory_utils_headers.sh"
  - "tools/ci/check_blobs.sh"
  - "tools/ci/check_public_headers.py"

.patterns-host_test: &patterns-host_test
  - ".gitlab/ci/host-test.yml"

  - "components/**/*"

  - "tools/ci/test_autocomplete.py"

  - "tools/mass_mfg/**/*"

  - "tools/esp_app_trace/**/*"
  - "tools/ldgen/**/*"

  - "tools/idf_monitor.py"

  - "tools/idf.py"
  - "tools/idf_py_actions/**/*"
  - "tools/test_idf_py/**/*"

  - "tools/idf_size.py"

  - "tools/tools.json"
  - "tools/tools_schema.json"
  - "tools/idf_tools.py"
  - "tools/test_idf_tools/**/*"
  - "tools/install_util.py"

  - "tools/requirements/*"
  - "tools/requirements.json"
  - "tools/requirements_schema.json"

  - "tools/mkdfu.py"
  - "tools/test_mkdfu/**/*"

  - "tools/kconfig_new/**/*"

  - "tools/detect_python.sh"
  - "tools/detect_python.fish"

  - "tools/ci/test_reproducible_build.sh"

  - "tools/gen_soc_caps_kconfig/*"
  - "tools/gen_soc_caps_kconfig/test/test_gen_soc_caps_kconfig.py"

  - "tools/mkuf2.py"

  - "tools/split_paths_by_spaces.py"

  - "tools/check_python_dependencies.py"

.patterns-docker: &patterns-docker
  - "tools/docker/**/*"

.patterns-submodule: &patterns-submodule
  - "components/bootloader/subproject/components/micro-ecc/micro-ecc"
  - "components/bt/controller/lib_esp32"
  - "components/bt/controller/lib_esp32c2/esp32c2-bt-lib"
  - "components/bt/controller/lib_esp32c3_family"
  - "components/bt/controller/lib_esp32h2/esp32h2-bt-lib"
  - "components/bt/host/nimble/nimble"
  - "components/cmock/CMock"
  - "components/esp_phy/lib"
  - "components/esp_wifi/lib"
  - "components/esp_coex/lib"
  - "components/json/cJSON"
  - "components/lwip/lwip"
  - "components/mbedtls/mbedtls"
  - "components/mqtt/esp-mqtt"
  - "components/openthread/lib"
  - "components/openthread/openthread"
  - "components/protobuf-c/protobuf-c"
  - "components/spiffs/spiffs"
  - "components/unity/unity"
  - "components/heap/tlsf"
  - "components/bt/controller/lib_esp32c6/esp32c6-bt-lib"
  - "components/bt/esp_ble_mesh/lib/lib"
  - ".gitmodules"

.patterns-danger-npm: &patterns-danger-npm
  - ".gitlab/dangerjs/package-lock.json"

# for jobs: flash_encryption_wifi_high_traffic
.patterns-example_test-ota-nightly_run: &patterns-example_test-ota-nightly_run
  - "examples/system/ota/**/*"
  - "examples/common_components/protocol_examples_common/**/*"
  - "components/app_update/include/*"
  - "components/app_update/*"
  - "components/esp_https_ota/**/*"

# for jobs: example_test*ethernet*
.patterns-example_test-ethernet: &patterns-example_test-ethernet
  - "tools/ci/python_packages/common_test_methods.py"
  - "examples/common_components/**/*"
  - "examples/protocols/**/*"
  - "examples/system/ota/**/*"
  - "examples/ethernet/iperf/**/*"
  - "examples/network/vlan_support/**/*"
  - "components/esp_eth/??[!s][!t]*/**/*"
  - "components/esp_eth/???/**/*"
  - "components/esp_eth/*"
  - "components/esp_netif/esp_netif_handlers.c"

# for jobs: example_test*wifi*
.patterns-example_test-wifi: &patterns-example_test-wifi
  - "tools/ci/python_packages/common_test_methods.py"
  - "examples/common_components/protocol_examples_common/**/*"
  - "examples/protocols/**/*"
  - "examples/wifi/**/*"
  - "examples/network/simple_sniffer/**/*"

  - "components/mbedtls/port/dynamic/*"
  # ota
  - "examples/system/ota/**/*"
  - "components/app_update/include/*"
  - "components/app_update/*"
  - "components/esp_https_ota/**/*"

# for jobs: custom_test*wifi*
.patterns-custom_test-wifi: &patterns-custom_test-wifi
  - "tools/test_apps/phy/**/*"

# for jobs: example_test_pytest_sdio related
.patterns-example_test-sdio: &patterns-example_test-sdio
  - "components/hal/sdio*.c"
  - "components/hal/include/hal/sdio*.h"
  - "components/driver/sdspi*.c"
  - "components/driver/sdio*.c"
  - "components/driver/sdmmc*.c"
  - "components/driver/include/driver/sdspi*.h"
  - "components/driver/include/driver/sdio*.h"
  - "components/driver/include/driver/sdmmc*.h"
  - "components/sdmmc/??[!s][!t]*/**/*"
  - "components/sdmmc/???/**/*"
  - "components/sdmmc/*"
  - "examples/peripherals/sdio/**/*"

# for jobs: component_ut_pytest_sdio related
.patterns-component_ut-sdio: &patterns-component_ut-sdio
  - "components/hal/sdio*.c"
  - "components/hal/include/hal/sdio*.h"
  - "components/driver/sdspi*.c"
  - "components/driver/sdio*.c"
  - "components/driver/sdmmc*.c"
  - "components/driver/include/driver/sdspi*.h"
  - "components/driver/include/driver/sdio*.h"
  - "components/driver/include/driver/sdmmc*.h"
  - "components/sdmmc/**/*"

# for jobs: component_ut_pytest_flash_multi
.patterns-component_ut-flash_multi: &patterns-component_ut-flash_multi
  - "components/spi_flash/**/*"
  - "components/hal/spi_flash*.c"
  - "components/hal/include/hal/spi_flash*.h"

# for jobs: USB host and device examples
.patterns-example_test-usb: &patterns-example_test-usb
  - "components/hal/usb*.c"
  - "components/hal/esp32s*/include/hal/usb*.h"
  - "components/usb/*include/**/*"
  - "components/usb/*"
  - "examples/peripherals/usb/host/**/**/**/*"
  - "examples/peripherals/usb/device/**/**/*"

# for jobs: USB component (Host) pytest test_app
.patterns-component_ut-usb: &patterns-component_ut-usb
  - "components/hal/usb*.c"
  - "components/hal/esp32s*/include/hal/usb*.h"
  - "components/usb/**/*"

# for jobs: *_pytest_esp32x_adc:
.patterns-target_test-adc: &patterns-target_test-adc
  - "components/{esp_adc,driver,hal,esp_hw_support,efuse}/???[!t]*/**/*"
  - "components/{esp_adc,driver,hal,esp_hw_support,efuse}/??[!s]?*/**/*"
  - "components/{esp_adc,driver,hal,esp_hw_support,efuse}/???/**/*"
  - "components/{esp_adc,driver,hal,esp_hw_support,efuse}/??/**/*"
  - "components/{esp_adc,driver,hal,esp_hw_support,efuse}/*"

.patterns-component_ut-adc: &patterns-component_ut-adc
  - "components/esp_adc/**/*"

.patterns-example_test-adc: &patterns-example_test-adc
  - "examples/peripherals/adc/**/*"

.patterns-target_test-ecdsa: &patterns-target_test-ecdsa
  - "components/{hal,efuse}/???[!t]*/**/*"
  - "components/{hal,efuse}/??[!s]?*/**/*"
  - "components/{hal,efuse}/???/**/*"
  - "components/{hal,efuse}/??/**/*"
  - "components/{hal,efuse}/*"
  - "components/mbedtls/port/ecdsa/*"

.patterns-component_ut-nvs_encr_hmac: &patterns-component_ut-nvs_encr_hmac
  - "components/nvs_flash/**/*"
  - "components/nvs_sec_provider/**/*"

.patterns-example_test-nvs_encr_hmac: &patterns-example_test-nvs_encr_hmac
  - "components/{nvs_flash,nvs_sec_provider}/???[!t]*/**/*"
  - "components/{nvs_flash,nvs_sec_provider}/??[!s]?*/**/*"
  - "components/{nvs_flash,nvs_sec_provider}/???/**/*"
  - "components/{nvs_flash,nvs_sec_provider}/??/**/*"
  - "components/{nvs_flash,nvs_sec_provider}/*"
  - "examples/security/nvs_encryption_hmac/**/*"

##############
# if anchors #
##############
.if-ref-master: &if-ref-master
  if: '$CI_COMMIT_REF_NAME == "master"'

.if-tag-release: &if-tag-release
  if: '$CI_COMMIT_TAG =~ /^v\d+\.\d+(\.\d+)?($|-)/'

.if-protected: &if-protected
  if: '($CI_COMMIT_REF_NAME == "master" || $CI_COMMIT_BRANCH =~ /^release\/v/ || $CI_COMMIT_TAG =~ /^v\d+\.\d+(\.\d+)?($|-)/) || $CI_COMMIT_TAG =~ /^qa-test/'

.if-protected-no_label: &if-protected-no_label
  if: '($CI_COMMIT_REF_NAME == "master" || $CI_COMMIT_BRANCH =~ /^release\/v/ || $CI_COMMIT_TAG =~ /^v\d+\.\d+(\.\d+)?($|-)/) && $BOT_TRIGGER_WITH_LABEL == null'

.if-qa-test-tag: &if-qa-test-tag
  if: '$CI_COMMIT_TAG =~ /^qa-test/'

.if-dev-push: &if-dev-push
  if: '$CI_COMMIT_REF_NAME != "master" && $CI_COMMIT_BRANCH !~ /^release\/v/ && $CI_COMMIT_TAG !~ /^v\d+\.\d+(\.\d+)?($|-)/ && $CI_COMMIT_TAG !~ /^qa-test/ && ($CI_PIPELINE_SOURCE == "push" || $CI_PIPELINE_SOURCE == "merge_request_event")'

.if-merge_request: &if-merge_request
  if: '$CI_PIPELINE_SOURCE == "merge_request_event"'

.if-schedule: &if-schedule
  if: '$CI_PIPELINE_SOURCE == "schedule"'

.if-trigger: &if-trigger
  if: '$CI_PIPELINE_SOURCE == "trigger"'

.if-label-build-only: &if-label-build-only
  if: '$CI_JOB_STAGE == "target_test" && $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*For Maintainers: Only Build Tests(?:,[^,\n\r]+)*$/i'

.if-label-upload_cache: &if-label-upload_cache
  if: '$CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*upload_cache(?:,[^,\n\r]+)*$/i'

.if-revert-branch: &if-revert-branch
  if: '$CI_MERGE_REQUEST_SOURCE_BRANCH_NAME =~ /^revert-/'

#####################
# Specific if rules #
#####################
.if-example_test-ota-include_nightly_run-rule: &if-example_test-ota-include_nightly_run-rule
  <<: *if-dev-push
  changes: *patterns-example_test-ota-nightly_run
  variables:
    INCLUDE_NIGHTLY_RUN: "1"

#########
# Rules #
#########
### Branches ###
.rules:protected:
  rules:
    - <<: *if-protected

.rules:push_to_github:
  rules:
    - <<: *if-qa-test-tag
      when: never
    - <<: *if-protected-no_label

.rules:protected-no_label-always:
  rules:
    - <<: *if-qa-test-tag
      when: never
    - <<: *if-protected-no_label
      when: always

.rules:mr:
  rules:
    - <<: *if-merge_request

.rules:tag:release:
  rules:
    - <<: *if-tag-release

### Patterns ###
.rules:patterns:python-cache:
  rules:
    - *if-schedule
    - <<: *if-label-upload_cache
      when: manual
    - <<: *if-dev-push
      changes: *patterns-python-cache

.rules:patterns:submodule:
  rules:
    - <<: *if-label-upload_cache
      when: manual
    - <<: *if-dev-push
      changes: *patterns-submodule

.rules:patterns:dangerjs:
  rules:
    - <<: *if-label-upload_cache
      when: manual
    - <<: *if-dev-push
      changes: *patterns-danger-npm

.rules:patterns:clang_tidy:
  rules:
    - <<: *if-protected
    - <<: *if-dev-push
      changes: *patterns-c-files

.rules:patterns:python-files:
  rules:
    - <<: *if-protected
    - <<: *if-dev-push
      changes: *patterns-python-files

# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
# DO NOT place comments or maintain any code from this line
#
# Use dependencies.yml and generate_rules.py under .gitlab/ci/dependencies dir
# to generate labels and rules
# Could also use pre-commit hook to finish this if detected changes on
# these two files
# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

##################
# Auto Generated #
##################
.if-label-build: &if-label-build
  if: '$BOT_LABEL_BUILD || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*build(?:,[^,\n\r]+)*$/i'

.if-label-component_ut: &if-label-component_ut
  if: '$BOT_LABEL_COMPONENT_UT || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32: &if-label-component_ut_esp32
  if: '$BOT_LABEL_COMPONENT_UT_ESP32 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32c2: &if-label-component_ut_esp32c2
  if: '$BOT_LABEL_COMPONENT_UT_ESP32C2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32c2(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32c3: &if-label-component_ut_esp32c3
  if: '$BOT_LABEL_COMPONENT_UT_ESP32C3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32c3(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32c6: &if-label-component_ut_esp32c6
  if: '$BOT_LABEL_COMPONENT_UT_ESP32C6 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32c6(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32h2: &if-label-component_ut_esp32h2
  if: '$BOT_LABEL_COMPONENT_UT_ESP32H2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32h2(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32p4: &if-label-component_ut_esp32p4
  if: '$BOT_LABEL_COMPONENT_UT_ESP32P4 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32p4(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32s2: &if-label-component_ut_esp32s2
  if: '$BOT_LABEL_COMPONENT_UT_ESP32S2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32s2(?:,[^,\n\r]+)*$/i'

.if-label-component_ut_esp32s3: &if-label-component_ut_esp32s3
  if: '$BOT_LABEL_COMPONENT_UT_ESP32S3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*component_ut_esp32s3(?:,[^,\n\r]+)*$/i'

.if-label-custom_test: &if-label-custom_test
  if: '$BOT_LABEL_CUSTOM_TEST || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32: &if-label-custom_test_esp32
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32c2: &if-label-custom_test_esp32c2
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32C2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32c2(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32c3: &if-label-custom_test_esp32c3
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32C3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32c3(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32c6: &if-label-custom_test_esp32c6
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32C6 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32c6(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32h2: &if-label-custom_test_esp32h2
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32H2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32h2(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32p4: &if-label-custom_test_esp32p4
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32P4 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32p4(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32s2: &if-label-custom_test_esp32s2
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32S2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32s2(?:,[^,\n\r]+)*$/i'

.if-label-custom_test_esp32s3: &if-label-custom_test_esp32s3
  if: '$BOT_LABEL_CUSTOM_TEST_ESP32S3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*custom_test_esp32s3(?:,[^,\n\r]+)*$/i'

.if-label-docker: &if-label-docker
  if: '$BOT_LABEL_DOCKER || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*docker(?:,[^,\n\r]+)*$/i'

.if-label-example_test: &if-label-example_test
  if: '$BOT_LABEL_EXAMPLE_TEST || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32: &if-label-example_test_esp32
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32c2: &if-label-example_test_esp32c2
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32C2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32c2(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32c3: &if-label-example_test_esp32c3
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32C3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32c3(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32c6: &if-label-example_test_esp32c6
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32C6 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32c6(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32h2: &if-label-example_test_esp32h2
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32H2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32h2(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32p4: &if-label-example_test_esp32p4
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32P4 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32p4(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32s2: &if-label-example_test_esp32s2
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32S2 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32s2(?:,[^,\n\r]+)*$/i'

.if-label-example_test_esp32s3: &if-label-example_test_esp32s3
  if: '$BOT_LABEL_EXAMPLE_TEST_ESP32S3 || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*example_test_esp32s3(?:,[^,\n\r]+)*$/i'

.if-label-host_test: &if-label-host_test
  if: '$BOT_LABEL_HOST_TEST || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*host_test(?:,[^,\n\r]+)*$/i'

.if-label-macos: &if-label-macos
  if: '$BOT_LABEL_MACOS || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*macos(?:,[^,\n\r]+)*$/i'

.if-label-macos_test: &if-label-macos_test
  if: '$BOT_LABEL_MACOS_TEST || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*macos_test(?:,[^,\n\r]+)*$/i'

.if-label-nvs_coverage: &if-label-nvs_coverage
  if: '$BOT_LABEL_NVS_COVERAGE || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*nvs_coverage(?:,[^,\n\r]+)*$/i'

.if-label-submodule: &if-label-submodule
  if: '$BOT_LABEL_SUBMODULE || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*submodule(?:,[^,\n\r]+)*$/i'

.if-label-target_test: &if-label-target_test
  if: '$BOT_LABEL_TARGET_TEST || $CI_MERGE_REQUEST_LABELS =~ /^(?:[^,\n\r]+,)*target_test(?:,[^,\n\r]+)*$/i'

.rules:build:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools

.rules:build:check:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-dev-push
      changes: *patterns-build_check
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools

.rules:build:component_ut:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-component_ut_esp32p4
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:component_ut-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32
    - <<: *if-label-custom_test_esp32c2
    - <<: *if-label-custom_test_esp32c3
    - <<: *if-label-custom_test_esp32c6
    - <<: *if-label-custom_test_esp32h2
    - <<: *if-label-custom_test_esp32p4
    - <<: *if-label-custom_test_esp32s2
    - <<: *if-label-custom_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:custom_test-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:docker:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-docker
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-docker
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-submodule

.rules:build:example_test:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-example_test-ota-include_nightly_run-rule
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-example_test_esp32h2
    - <<: *if-label-example_test_esp32p4
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-example_test-ota-include_nightly_run-rule
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-example_test-ota-include_nightly_run-rule
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32p4:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32p4
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:example_test-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:build:macos:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build
    - <<: *if-label-macos
    - <<: *if-label-macos_test
    - <<: *if-dev-push
      changes: *patterns-build_macos
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools

.rules:build:target_test:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-example_test-ota-include_nightly_run-rule
    - <<: *if-label-build
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-component_ut_esp32p4
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32
    - <<: *if-label-custom_test_esp32c2
    - <<: *if-label-custom_test_esp32c3
    - <<: *if-label-custom_test_esp32c6
    - <<: *if-label-custom_test_esp32h2
    - <<: *if-label-custom_test_esp32p4
    - <<: *if-label-custom_test_esp32s2
    - <<: *if-label-custom_test_esp32s3
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-example_test_esp32h2
    - <<: *if-label-example_test_esp32p4
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-build_components
    - <<: *if-dev-push
      changes: *patterns-build_system
    - <<: *if-dev-push
      changes: *patterns-build_template-app
    - <<: *if-dev-push
      changes: *patterns-component_ut
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-custom_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-downloadable-tools
    - <<: *if-dev-push
      changes: *patterns-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet
    - <<: *if-dev-push
      changes: *patterns-example_test-i154
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio
    - <<: *if-dev-push
      changes: *patterns-example_test-usb
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:labels:nvs_coverage:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-label-nvs_coverage

.rules:test:component_ut-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32-flash_multi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi

.rules:test:component_ut-esp32-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio

.rules:test:component_ut-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32c2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32c2-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:component_ut-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32c3-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32c3-flash_multi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi

.rules:test:component_ut-esp32c3-nvs_encr_hmac:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-nvs_encr_hmac

.rules:test:component_ut-esp32c3-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio

.rules:test:component_ut-esp32c3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:component_ut-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32c6-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32c6-i154:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-i154

.rules:test:component_ut-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32h2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32h2-ecdsa:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-target_test-ecdsa

.rules:test:component_ut-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32s2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32s2-flash_multi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi

.rules:test:component_ut-esp32s2-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-sdio

.rules:test:component_ut-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut

.rules:test:component_ut-esp32s3-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:component_ut-esp32s3-flash_multi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-flash_multi

.rules:test:component_ut-esp32s3-usb:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-usb

.rules:test:component_ut-esp32s3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-component_ut
    - <<: *if-label-component_ut_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-component_ut-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:custom_test-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32c2-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:custom_test-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32c3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:custom_test-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32s2-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:custom_test-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test

.rules:test:custom_test-esp32s3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-custom_test
    - <<: *if-label-custom_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-custom_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32-ethernet:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-ethernet

.rules:test:example_test-esp32-include_nightly_run-rule:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-example_test-ota-include_nightly_run-rule

.rules:test:example_test-esp32-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio

.rules:test:example_test-esp32-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32c2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32c2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32c2-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32c3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32c3-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32c3-include_nightly_run-rule:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-example_test-ota-include_nightly_run-rule

.rules:test:example_test-esp32c3-nvs_encr_hmac:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-nvs_encr_hmac

.rules:test:example_test-esp32c3-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio

.rules:test:example_test-esp32c3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32c6:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32c6-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32c6-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32c6
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32h2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32h2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32h2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32s2:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32s2-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32s2-sdio:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-sdio

.rules:test:example_test-esp32s2-usb:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-usb

.rules:test:example_test-esp32s2-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s2
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-esp32s3:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-build-example_test
    - <<: *if-dev-push
      changes: *patterns-example_test

.rules:test:example_test-esp32s3-adc:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-adc
    - <<: *if-dev-push
      changes: *patterns-target_test-adc

.rules:test:example_test-esp32s3-wifi:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-example_test_esp32s3
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-wifi
    - <<: *if-dev-push
      changes: *patterns-target_test-wifi

.rules:test:example_test-i154:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-example_test
    - <<: *if-label-target_test
    - <<: *if-dev-push
      changes: *patterns-example_test-i154

.rules:test:host_test:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-host_test
    - <<: *if-dev-push
      changes: *patterns-host_test

.rules:test:submodule:
  rules:
    - <<: *if-revert-branch
      when: never
    - <<: *if-protected
    - <<: *if-label-build-only
      when: never
    - <<: *if-label-submodule
    - <<: *if-dev-push
      changes: *patterns-submodule
